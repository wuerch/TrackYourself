(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[329],{9830:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/kalorien",function(){return a(9142)}])},593:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=a(2648).Z,l=a(7294),i=n(a(9351)),s=a(1163);async function r(){let{userContext:e,setUserContext:t}=(0,l.useContext)(i.default),a=(0,s.useRouter)();(0,l.useEffect)(()=>{e||fetch("/api/user",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{200==e.status?t(e.user):a.push("/")})},[])}e.exports={handleContext:r}},9142:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var n=a(5893),l=a(7294),i=a(9351),s=function(e){let{userContext:t,setUserContext:a}=(0,l.useContext)(i.default),[s,r]=(0,l.useState)(new Date().toISOString().substring(0,10)),[o,c]=(0,l.useState)({mahlzeit:"",gewicht:"",kalorien:""});function h(e){let{name:t,value:a}=e.target;var n=e.target.name;"date"===n?r(a):"mahlzeit"===n?c(e=>({...e,[t]:a.replace(/[^a-zA-zäöüÄÖÜß 1-9]/,"")})):"gewicht"===n?c(e=>({...e,[t]:a.replace(/[^0-9]/,"")})):"kalorien"===n&&c(e=>({...e,[t]:a.replace(/[^0-9]/,"")}))}async function d(e){e.preventDefault(),await fetch(t.base_url+"/api/mahlzeit",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:s+"T00:00:00.000Z",mahlzeit:{mahlzeit:o.mahlzeit,gewicht:Number(o.gewicht),kalorien:Number(o.kalorien)}})}).then(e=>e.json()).then(e=>{200===e.status&&(a(e=>({...e,kalorien:function(e){if(!e.find(e=>e.date===s+"T00:00:00.000Z"))return console.log("No date found, created a new one."),[...e,{date:s+"T00:00:00.000Z",mahlzeiten:[{mahlzeit:o.mahlzeit,gewicht:Number(o.gewicht),kalorien:Number(o.kalorien)}]}];{console.log("Date found, added to the object.");let t=e.map(e=>e.date===s+"T00:00:00.000Z"?{...e,mahlzeiten:[...e.mahlzeiten,o]}:e);return t}}(t.kalorien)})),c({mahlzeit:"",gewicht:"",kalorien:""}))}).catch()}return(0,n.jsx)("div",{children:(0,n.jsxs)("form",{className:"text-black flex flex-col md:flex-row w-[80%] mx-[10%]",action:"/api/workouts",method:"POST",children:[(0,n.jsx)("input",{onChange:h,className:"mt-2 rounded h-8 w-[100%]",type:"date",name:"date",placeholder:"Date",value:s}),(0,n.jsx)("input",{onChange:h,className:"mt-2 rounded h-8 w-full",name:"mahlzeit",placeholder:"Mahlzeit",value:o.mahlzeit}),(0,n.jsx)("input",{onChange:h,className:"mt-2 rounded h-8 w-full",name:"gewicht",placeholder:"Gramm",value:o.gewicht}),(0,n.jsx)("input",{onChange:h,className:"mt-2 rounded h-8 w-full",name:"kalorien",placeholder:"Kalorien",value:o.kalorien}),(0,n.jsx)("button",{onClick:d,className:"border-[1px] rounded mt-2 h-8 w-full bg-[#369623]",children:(0,n.jsx)("p",{className:"text-white",children:"Add"})})]})})},r=a(3343),o=function(){let{userContext:e,setUserContext:t}=(0,l.useContext)(i.default);async function a(a,n){let{mahlzeit:l}=a;await fetch(e.base_url+"/api/mahlzeit",{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({mahlzeit:l,date:n})}).then(e=>e.json()).then(a=>{if(200===a.status){let i=function(e,t,a){let n=e.map(e=>{if(e.date!==a)return e;{let n=e.mahlzeiten.filter(e=>e.mahlzeit!==t.mahlzeit|e.gewicht!==t.gewicht|e.kalorien!==t.kalorien);return{date:e.date,_id:e._id,mahlzeiten:n}}});return n}(e.kalorien,l,n);t(e=>({...e,kalorien:i}))}}).catch(e=>console.error("Error:",e))}return(0,n.jsx)("div",{className:"text-red flex flex-col mt-2",children:e&&e.kalorien&&e.kalorien.length>0?e.kalorien.map((e,t)=>(0,n.jsxs)("div",{children:[e.mahlzeiten&&e.mahlzeiten.length>0?(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"gradient",children:e.date.slice(0,10)}),(0,n.jsxs)("div",{className:"flex justify-around",children:[(0,n.jsx)("p",{className:"basis-0 grow",children:"Mahlzeit"}),(0,n.jsx)("p",{className:"basis-0 grow",children:"Gramm"}),(0,n.jsx)("p",{className:"basis-0 grow",children:"Kalorien"}),(0,n.jsx)("p",{className:"basis-0 grow-[0.5]",children:"Delete"})]}),(0,n.jsx)("hr",{})]}):"",e.mahlzeiten.map((t,l)=>(0,n.jsxs)("div",{className:"flex justify-around",children:[(0,n.jsx)("p",{className:"basis-0 grow",children:t.mahlzeit}),(0,n.jsxs)("p",{className:"basis-0 grow",children:[t.gewicht," g"]}),(0,n.jsxs)("p",{className:"basis-0 grow",children:[t.kalorien," kcal"]}),(0,n.jsx)("div",{className:"basis-0 grow-[0.5] flex justify-center",children:(0,n.jsx)("div",{className:"w-min h-min bg-[#BA1000] hover:cursor-pointer",onClick:()=>a({mahlzeit:t},e.date),children:(0,n.jsx)(r.Z,{})})})]},l))]},t)):""})},c=a(593),h=function(){return(0,c.handleContext)(),(0,n.jsxs)("div",{className:"min-h-screen",children:[(0,n.jsx)(s,{}),(0,n.jsx)(o,{})]})}}},function(e){e.O(0,[343,774,888,179],function(){return e(e.s=9830)}),_N_E=e.O()}]);